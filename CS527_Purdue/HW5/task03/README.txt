The program contains a heap overflow vulnerability since there is no bound check when writing to heap (in this case I will be overwriting a function pointer at ppcVar2). A format string vulnerability could be exploited to read the address of printf. Then using the offset between printf and system that I got using gdb, I managed to deduce the address of system despite PIE. Finally I overwrote in the address at ppcVar2 with that of system after the padding, then overwrote the argument with 'cat flag.txt'. Since setreuid is called beforehand, the command is executed with elevated privilege. Please see my code for details.
