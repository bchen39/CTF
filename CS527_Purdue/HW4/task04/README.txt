Since the server forks without changing its address layout, I successfully leaked the canary by trying each byte and brute forced the rbp into redirecting to secret_function (since the last one and a half byte and the first six bytes are alwasy the same as the rbp, it is easy to brute force). My next step would be finding the passcode in secret_function using gdb by breaking in the loop function changing the rip directly, The passcode is 5803290005. Please see code for the payload generation process.
